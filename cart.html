<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ö–æ—Ä–∑–∏–Ω–∞ ‚Äî Sea Tori</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="header">
    <div class="container">
      <div class="logo">Sea Tori</div>
      <nav class="nav" id="main-nav">
        <a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a>
        <a href="menu.html">–ú–µ–Ω—é</a>
        <a href="cart.html" class="active">–ö–æ—Ä–∑–∏–Ω–∞</a>
        <a href="profile.html" id="profile-link">–ü—Ä–æ—Ñ–∏–ª—å</a>
      </nav>
      <div class="burger" id="burger-menu">
        <span></span><span></span><span></span>
      </div>
    </div>
  </header>
  <main class="main">
    <h2 class="page-title">–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h2>
    <section class="cart-items" id="cart-items">
      <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
    </section>
    <div class="btn-center" style="margin-bottom:18px;">

    </div>
    <section class="cart-summary">
      <div class="cart-total">–ò—Ç–æ–≥–æ: <span id="cart-total">0 ‚ÇΩ</span></div>
      <button id="go-to-order" class="btn btn-primary">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
    </section>
  </main>
  <footer class="footer new-footer">
    <div class="container">
      <div class="footer-main">
        <div class="footer-logo-block">
          <div class="footer-logo">Sea Tori <span style='font-size:1.3em;'>üç£</span></div>
          <div class="footer-desc">–ö–∞—Ñ–µ –∏ —Å—É—à–∏-–±–∞—Ä –≤ —è–ø–æ–Ω—Å–∫–æ–º —Å—Ç–∏–ª–µ.<br>–°–≤–µ–∂–∏–µ –±–ª—é–¥–∞, —É—é—Ç–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞.</div>
        </div>
        <div class="footer-contacts-block">
          <div class="footer-contacts-title">–ö–æ–Ω—Ç–∞–∫—Ç—ã</div>
          <div class="footer-contacts-list">
            <span>+7 999 888 77 66</span>
            <span>seatori@mail.ru</span>
            <span>–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –Ø–ø–æ–Ω—Å–∫–∞—è, 7</span>
            <span>–ü–Ω-–í—Å: 11:00‚Äì23:00</span>
          </div>
        </div>
        <div class="footer-socials-block">
          <div class="footer-contacts-title">–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</div>
          <div class="footer-socials">
            <a href="https://t.me/sea_tori" aria-label="Telegram" target="_blank"><img src="img/telegram.svg" alt="Telegram" class="footer-icon"></a>
            <a href="https://instagram.com/sea_tori" aria-label="Instagram" target="_blank"><img src="img/instagram.svg" alt="Instagram" class="footer-icon"></a>
            <a href="https://vk.com/sea_tori" aria-label="VK" target="_blank"><img src="img/vk.svg" alt="VK" class="footer-icon"></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <span>¬© 2024 Sea Tori. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</span>
        <span>–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –Ø–ø–æ–Ω–∏–∏ <span style='font-size:1.1em;'>‚õ©Ô∏è</span></span>
      </div>
    </div>
  </footer>
  <div id="toast" class="toast"></div>
  <script>
    if (!localStorage.getItem('currentUser')) window.location.href = 'login.html';

    // –ü—Ä–æ—Å—Ç—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ—Ä–∑–∏–Ω–æ–π
    function getCart() {
      try {
        return JSON.parse(localStorage.getItem('cart') || '[]');
      } catch (e) { return []; }
    }
    function setCart(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
    }
    function getDelivery() {
      try {
        return JSON.parse(localStorage.getItem('delivery') || 'null');
      } catch (e) { return null; }
    }
    function renderCart() {
      const cart = getCart();
      const delivery = getDelivery();
      const itemsWrap = document.getElementById('cart-items');
      const totalWrap = document.getElementById('cart-total');
      itemsWrap.innerHTML = '';
      let total = 0;
      if (cart.length === 0) {
        itemsWrap.innerHTML = '<div style="text-align:center;color:#bbb;font-size:1.2em;margin:32px 0;">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</div>';
        totalWrap.textContent = '0 ‚ÇΩ';
        return;
      }
      cart.forEach(item => {
        total += (item.price * (item.count || 1));
        const el = document.createElement('div');
        el.className = 'cart-item';
        el.innerHTML = `
          <div style="display:flex;align-items:center;gap:14px;">
            ${item.img ? `<img src="${item.img}" alt="${item.name}" style="width:54px;height:54px;object-fit:cover;border-radius:12px;">` : ''}
            <div>
              <div class="cart-item-title">${item.name}</div>
              <div style="color:#bbb;font-size:0.98em;">${item.desc || ''}</div>
            </div>
          </div>
          <div style="display:flex;flex-direction:column;align-items:end;gap:6px;">
            <div class="cart-item-price">${item.price} ‚ÇΩ √ó ${item.count || 1}</div>
            <button class="cart-item-remove" title="–£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã">‚úï</button>
          </div>
        `;
        el.querySelector('.cart-item-remove').onclick = () => {
          const cartNow = getCart();
          const idx = cartNow.findIndex(i => i.id === item.id);
          if (idx > -1) {
            cartNow.splice(idx, 1);
            setCart(cartNow);
            renderCart();
          }
        };
        itemsWrap.appendChild(el);
      });
      // –î–æ—Å—Ç–∞–≤–∫–∞
      let deliveryBlock = document.createElement('div');
      deliveryBlock.className = 'cart-item';
      if (delivery) {
        deliveryBlock.innerHTML = `<div class="cart-item-title">–î–æ—Å—Ç–∞–≤–∫–∞: <b>${delivery.name}</b></div><div class="cart-item-price">${delivery.price} ‚ÇΩ</div>`;
        total += delivery.price;
      } else {
        deliveryBlock.innerHTML = `<div class="cart-item-title" style="color:#e64b4b;">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ—Å—Ç–∞–≤–∫—É –≤ –º–µ–Ω—é!</div><div class="cart-item-price">0 ‚ÇΩ</div>`;
      }
      itemsWrap.appendChild(deliveryBlock);
      totalWrap.textContent = total + ' ‚ÇΩ';
    }
    document.addEventListener('DOMContentLoaded', renderCart);
    // –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞
    document.getElementById('go-to-order').onclick = function(e) {
      e.preventDefault();
      window.location.href = 'order.html';
    };
  </script>
</body>
</html>